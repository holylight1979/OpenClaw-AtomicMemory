# /init-project — 專案知識庫初始化

> 為當前專案建立 `_AIDocs/` 知識庫骨架與記憶工作流。
> 此 Skill 應在每次 session 開始時，偵測到專案**無 `_AIDocs/` 目錄**且**有足夠規模（50+ 檔案）**時自動執行。

---

## 執行流程

### Step 1: 環境偵測

1. 確認當前工作目錄下是否已存在 `_AIDocs/` 目錄
   - 若已存在 → 跳過初始化，直接讀取 `_AIDocs/_INDEX.md` 確認知識庫完整性
   - 若不存在 → 繼續 Step 2
2. 統計專案原始碼檔案數量（排除 `node_modules`、`bin`、`obj`、`.git`、`packages` 等）
   - 若 < 50 檔案 → 告知使用者「專案規模較小，建議有需要時再手動執行 `/init-project`」，結束
   - 若 >= 50 檔案 → 繼續 Step 2

### Step 2: 專案掃描

使用 Explore agent 並行收集以下資訊：

1. **專案結構**：資料夾樹狀圖、各目錄 .cs/.ts/.py 等原始碼檔案數量
2. **進入點**：找 `Program.cs` / `Main` / `index.ts` 等入口
3. **框架識別**：從 `.csproj` / `package.json` / `requirements.txt` / `Cargo.toml` 判斷技術棧
4. **設定檔**：找 `appsettings.json` / `set.xml` / `.env` / `config.*` 等
5. **資料庫**：找 ORM / 資料存取模式（EF / Dapper / MysqlxCache / Prisma / SQLAlchemy 等）

### Step 3: 建立骨架

建立以下檔案：

```
_AIDocs/
  _INDEX.md          — 文件索引（含追蹤用途速查）
  _CHANGELOG.md      — 變更記錄（初始條目：「知識庫建立」）
  Project_File_Tree.md — 專案結構摘要
```

`_INDEX.md` 模板：

```markdown
# [專案名稱] — AI 分析文件索引

> 本資料夾包含由 AI 輔助產出的專案分析文件。
> 最近更新：[日期]

---

## 文件清單

| # | 文件名稱 | 說明 |
|---|---------|------|
| 1 | Project_File_Tree.md | 專案資料夾結構摘要 |

---

## 架構一句話摘要

[根據掃描結果填入]
```

### Step 4: 建立專案 CLAUDE.md（若不存在）

在專案根目錄建立 `CLAUDE.md`，內容：

```markdown
# [專案名稱] — 專案導讀 (Claude Code)

> [一句話描述]

## 風險分級（專案特定）

> 通用分級框架見全域 `~/.claude/CLAUDE.md`。

| 風險等級 | 本專案操作類型 | 驗證要求 |
|---------|--------------|---------|
| **高** | [根據專案填入] | 必須先讀取 _AIDocs 相關文件 + 原始碼 |
| **極高** | [根據專案填入] | 必須向使用者確認後才執行 |

## 技術約束

- [根據掃描結果填入]
```

### Step 5: 建立決策記憶檔（若不存在）

檢查 `memory/Extra_Efficiently_TokenSafe.md` 是否存在：
- 若不存在 → 建立空白模板：

```markdown
# 決策記憶 — 效率與 Token 節省

> 三層分類系統定義見全域 `~/.claude/CLAUDE.md`。

---

## 工程決策

（尚無記錄）

---

## 演化日誌

| 日期 | 記憶 | 變更 |
|------|------|------|
| [今日] | 知識庫建立 | 初始化 _AIDocs 與記憶工作流 |
```

### Step 6: 回報結果

向使用者彙報：
- 建立了哪些檔案
- 專案掃描摘要（技術棧、規模、關鍵發現）
- 建議後續可深入分析的方向

---

## 注意事項

- 不覆蓋已存在的檔案
- 不修改原始碼
- 所有產出為 Markdown 分析文件
- 若專案已有 `_AIDocs/`，改為檢查完整性（是否有 _INDEX.md、_CHANGELOG.md）並補齊缺失
